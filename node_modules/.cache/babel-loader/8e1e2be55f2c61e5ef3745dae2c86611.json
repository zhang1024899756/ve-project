{"ast":null,"code":"import \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/upload/style/css\";\nimport _Upload from \"antd/es/upload\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nvar _jsxFileName = \"/Users/zhangxinyu/Desktop/ve_project/src/components/comp-pictur.js\";\nimport React from 'react';\nexport default class ComponePictures extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      previewVisible: false,\n      previewImage: '',\n      fileList: []\n    };\n  }\n\n  _handleCancel() {\n    this.setState({\n      previewVisible: false\n    });\n  }\n\n  _handlePreview(file) {\n    this.setState({\n      previewImage: file.url || file.thumbUrl,\n      previewVisible: true\n    });\n  }\n\n  _handleChange(info) {\n    let fileList = info.fileList;\n    const fileIdList = []; //将已上传文件添加到记录\n\n    this.setState({\n      fileList\n    });\n    console.log(fileList[0]);\n\n    if (fileList.length >= 1 && fileList[0].response) {\n      for (var i = 0; i < fileList.length; i++) {\n        console.log(i);\n        fileIdList.push(fileList[i].response.data.image_src);\n      }\n\n      console.log(fileList[0]);\n      this.props.handleChildValueChange(fileIdList);\n    } else {\n      this.props.handleChildValueChange(fileIdList);\n    }\n  }\n\n  _onRemove(file) {\n    const data = {\n      url: file.response.msg\n    };\n    const myFetchOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      mode: 'cors',\n      body: JSON.stringify(data)\n    };\n    console.log(file.response.msg);\n\n    if (data.url) {\n      fetch(\"http://localhost:8100/picture/remove\", myFetchOptions).then(res => {\n        if (res.ok) {\n          message.success('删除成功！');\n        } else {\n          message.error('删除失败！');\n        }\n      });\n    } else {\n      console.log('Url为空');\n    }\n  }\n\n  render() {\n    const _this$state = this.state,\n          previewVisible = _this$state.previewVisible,\n          previewImage = _this$state.previewImage,\n          fileList = _this$state.fileList;\n    const uploadButton = React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ant-upload-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, \"Upload\"));\n    return React.createElement(\"div\", {\n      className: \"clearfix\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(_Upload, {\n      action: \"http://localhost:8100/picture/upload\",\n      listType: \"picture-card\",\n      fileList: fileList,\n      onPreview: this._handlePreview.bind(this),\n      onChange: this._handleChange.bind(this),\n      onRemove: this._onRemove.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, fileList.length >= 2 ? null : uploadButton), React.createElement(_Modal, {\n      visible: previewVisible,\n      footer: null,\n      onCancel: this._handleCancel.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      alt: \"example\",\n      style: {\n        width: '100%'\n      },\n      src: previewImage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    })));\n  }\n\n}","map":{"version":3,"sources":["/Users/zhangxinyu/Desktop/ve_project/src/components/comp-pictur.js"],"names":["React","ComponePictures","Component","constructor","state","previewVisible","previewImage","fileList","_handleCancel","setState","_handlePreview","file","url","thumbUrl","_handleChange","info","fileIdList","console","log","length","response","i","push","data","image_src","props","handleChildValueChange","_onRemove","msg","myFetchOptions","method","headers","mode","body","JSON","stringify","fetch","then","res","ok","message","success","error","render","uploadButton","bind","width"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Upload, Icon, Modal } from 'antd';\n\nexport default class ComponePictures extends React.Component {\n  constructor() {\n\t\tsuper();\n\t\tthis.state = {\n      previewVisible: false,\n      previewImage: '',\n      fileList: []\n\t\t};\n  };\n\n  _handleCancel () {\n    this.setState({ previewVisible: false })\n  }\n\n  _handlePreview (file) {\n    this.setState({\n      previewImage: file.url || file.thumbUrl,\n      previewVisible: true,\n    });\n  }\n\n  _handleChange (info) {\n    let fileList = info.fileList;\n    const fileIdList = [];\n    //将已上传文件添加到记录\n    this.setState({ fileList })\n    console.log(fileList[0])\n    if (fileList.length >= 1 && fileList[0].response ) {\n      for (var i = 0; i < fileList.length;i++) {\n        console.log(i)\n        fileIdList.push(fileList[i].response.data.image_src)\n      }\n      console.log(fileList[0])\n      this.props.handleChildValueChange(fileIdList)\n    }else {\n      this.props.handleChildValueChange(fileIdList)\n    }\n  }\n\n  _onRemove (file) {\n    const data = {url:file.response.msg};\n    const myFetchOptions = {\n      method: 'POST',\n      headers: {'Content-Type':'application/json'},\n      mode : 'cors',\n      body: JSON.stringify(data)\n    };\n    console.log(file.response.msg)\n    if (data.url) {\n      fetch(\"http://localhost:8100/picture/remove\",myFetchOptions)\n        .then((res) => {\n          if (res.ok) {\n             message.success('删除成功！');\n          }else {\n             message.error('删除失败！');\n          }\n        })\n    } else {\n      console.log('Url为空')\n    }\n\n  }\n\n\n  render() {\n    const { previewVisible, previewImage, fileList } = this.state;\n    const uploadButton = (\n      <div>\n        <Icon type=\"plus\" />\n        <div className=\"ant-upload-text\">Upload</div>\n      </div>\n    );\n    return (\n      <div className=\"clearfix\">\n        <Upload\n          action=\"http://localhost:8100/picture/upload\"\n          listType=\"picture-card\"\n          fileList={fileList}\n          onPreview={this._handlePreview.bind(this)}\n          onChange={this._handleChange.bind(this)}\n          onRemove={this._onRemove.bind(this)}\n        >\n          {fileList.length >= 2 ? null : uploadButton}\n        </Upload>\n        <Modal visible={previewVisible} footer={null} onCancel={this._handleCancel.bind(this)}>\n          <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\n        </Modal>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}