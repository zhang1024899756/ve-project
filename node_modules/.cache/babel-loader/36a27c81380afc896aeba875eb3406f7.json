{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _Dialog = require('../base/Dialog');\n\nvar _Dialog2 = _interopRequireDefault(_Dialog);\n\nvar _TabGroup = require('../base/TabGroup');\n\nvar _TabGroup2 = _interopRequireDefault(_TabGroup);\n\nvar _ImageUpload = require('./ImageUpload');\n\nvar _ImageUpload2 = _interopRequireDefault(_ImageUpload);\n\nvar _ImageSearch = require('./ImageSearch');\n\nvar _ImageSearch2 = _interopRequireDefault(_ImageSearch);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar ImageDialog = function (_Component) {\n  _inherits(ImageDialog, _Component);\n\n  function ImageDialog(props) {\n    _classCallCheck(this, ImageDialog);\n\n    var _this = _possibleConstructorReturn(this, (ImageDialog.__proto__ || Object.getPrototypeOf(ImageDialog)).call(this, props));\n\n    _this.state = {\n      images: [[], []],\n      handle: function handle() {}\n    };\n    return _this;\n  }\n\n  _createClass(ImageDialog, [{\n    key: 'open',\n    value: function open(handle) {\n      this.setState({\n        handle: handle\n      });\n      this.refs.modal.open();\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      if (this.refs.modal) {\n        this.refs.modal.close();\n\n        if (this.state.handle) {\n          this.state.handle();\n        }\n\n        this.refs.image.clearImages();\n      }\n    }\n  }, {\n    key: 'toggle',\n    value: function toggle(handle) {\n      this.setState({\n        handle: handle\n      });\n      this.refs.modal.toggle();\n    }\n  }, {\n    key: 'handleOkClick',\n    value: function handleOkClick(e) {\n      // 做相应的处理做相应的处理\n      var tabIndex = this.refs.tab.getTabIndex();\n      var images = this.state.images[tabIndex];\n      var strImgs = \"\";\n\n      if (images.length > 0 && this.state.handle) {\n        for (var i = 0; i < images.length; i++) {\n          var src = images[i].src;\n          var str = \"<img src='\" + src + \"'/>\";\n          strImgs += str;\n        }\n\n        this.state.handle(strImgs);\n      }\n\n      this.close();\n    }\n  }, {\n    key: 'handleChange',\n    value: function handleChange(index, imgs) {\n      var images = this.state.images;\n      images[index] = imgs;\n      this.setState({\n        images: images\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var uploader = this.props.uploader;\n      var customUploader = this.props.customUploader;\n      var buttons = [{\n        name: \"btn-ok\",\n        content: \"确定\",\n        onClick: this.handleOkClick.bind(this)\n      }, {\n        name: \"btn-cancel\",\n        content: \"取消\",\n        onClick: this.close.bind(this)\n      }];\n      var tabs = [{\n        title: \"本地上传\",\n        component: _react2.default.createElement(_ImageUpload2.default, _extends({\n          ref: 'image'\n        }, uploader, {\n          onChange: this.handleChange.bind(this),\n          customUploader: customUploader,\n          uploadImageCallback: this.props.uploadImageCallback\n        }))\n      }, {\n        title: \"网络图片\",\n        component: _react2.default.createElement(_ImageSearch2.default, {\n          ref: 'image',\n          onChange: this.handleChange.bind(this)\n        })\n      }];\n\n      if (this.props.hidden) {\n        return _react2.default.createElement('div', null);\n      } else {\n        return _react2.default.createElement(_Dialog2.default, {\n          ref: 'modal',\n          className: 'image-dialog',\n          width: 700,\n          height: 528,\n          title: \"\\u56FE\\u7247\",\n          buttons: buttons,\n          onClose: this.close.bind(this)\n        }, _react2.default.createElement(_TabGroup2.default, {\n          tabs: tabs,\n          ref: 'tab'\n        }));\n      }\n    }\n  }]);\n\n  return ImageDialog;\n}(_react.Component);\n\nexports.default = ImageDialog;\nImageDialog.propTypes = {\n  uploader: _propTypes2.default.object,\n  customUploader: _propTypes2.default.object\n};\nImageDialog.defaultProps = {\n  uploader: {\n    name: \"file\",\n    url: \"/upload\",\n    filter: function filter(res) {\n      return res.url;\n    },\n    data: {}\n  }\n};","map":null,"metadata":{},"sourceType":"script"}