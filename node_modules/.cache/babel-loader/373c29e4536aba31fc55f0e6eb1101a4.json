{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _EditorCore = require('./components/core/EditorCore');\n\nvar _EditorCore2 = _interopRequireDefault(_EditorCore);\n\nvar _EditorEventEmitter = require('./utils/EditorEventEmitter');\n\nvar _EditorEventEmitter2 = _interopRequireDefault(_EditorEventEmitter);\n\nrequire('../dist/less/editor.less');\n\nrequire('./utils/Date.js');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar Editor = function (_Component) {\n  _inherits(Editor, _Component);\n\n  function Editor(props) {\n    _classCallCheck(this, Editor);\n\n    var _this = _possibleConstructorReturn(this, (Editor.__proto__ || Object.getPrototypeOf(Editor)).call(this, props));\n\n    _this.handleChange = function () {\n      _this.setState({\n        loaded: true\n      });\n    };\n\n    _this.state = {\n      loaded: false,\n      reload: true\n    };\n    return _this;\n  }\n\n  _createClass(Editor, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.index = _EditorEventEmitter2.default.editorIndex;\n\n      _EditorEventEmitter2.default.addStartListener(\"start-\" + this.index, this.handleChange);\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var index = this.index;\n\n      _EditorEventEmitter2.default.removeStartListener(\"start-\" + index, this.handleChange);\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      if (this.state.loaded && this.state.reload) {\n        this.refs.editor.setContent(this.props.value || this.props.defaultValue);\n      }\n    }\n  }, {\n    key: 'handleMountSuccess',\n    value: function handleMountSuccess() {\n      _EditorEventEmitter2.default.mountEditorSuccess();\n    }\n  }, {\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      // reload判断当前是否可以允许刷新\n      // loaded状态变化时，务必重新刷新\n      var currentValue = nextProps.value;\n      var editorValue = this.getContent();\n\n      if (this.state.loaded != nextState.loaded) {\n        return true;\n      } else if (currentValue == editorValue) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: 'getContent',\n    value: function getContent() {\n      return this.refs.editor ? this.refs.editor.getContent() : \"\";\n    }\n  }, {\n    key: 'setContent',\n    value: function setContent(content) {\n      return this.refs.editor ? this.refs.editor.setContent(content) : \"\";\n    }\n  }, {\n    key: 'focusEditor',\n    value: function focusEditor() {\n      return this.refs.editor ? this.refs.editor.focusEditor() : \"\";\n    }\n  }, {\n    key: 'findDOMNode',\n    value: function findDOMNode(refName) {\n      return this.refs.editor ? this.refs.editor.findDOMNode(refName) : \"\";\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var loaded = this.state.loaded;\n\n      var _props = this.props,\n          value = _props.value,\n          defaultValue = _props.defaultValue,\n          props = _objectWithoutProperties(_props, ['value', 'defaultValue']);\n\n      if (!this.state.loaded) {\n        return _react2.default.createElement('div', {\n          id: props.id,\n          className: 'editor-contenteditable-div',\n          style: {\n            \"minHeight\": \"30px\",\n            \"border\": \"1px solid #ddd\"\n          }\n        }, \"\\u6B63\\u5728\\u52A0\\u8F7D...\");\n      } else {\n        return _react2.default.createElement(_EditorCore2.default, _extends({\n          ref: 'editor'\n        }, props, {\n          onEditorMount: this.handleMountSuccess\n        }));\n      }\n    }\n  }]);\n\n  return Editor;\n}(_react.Component);\n\nexports.default = Editor;\nEditor.propTypes = {\n  plugins: _propTypes2.default.object,\n  fontFamily: _propTypes2.default.array,\n  fontSize: _propTypes2.default.array,\n  paragraph: _propTypes2.default.array,\n  icons: _propTypes2.default.arrayOf(_propTypes2.default.string),\n  value: _propTypes2.default.string,\n  defaultValue: _propTypes2.default.string\n};\nEditor.defaultProps = {\n  \"plugins\": {\n    \"image\": {\n      \"uploader\": {\n        name: \"file\",\n        url: \"/upload\",\n        data: {},\n        filter: function filter(res) {\n          return res.url;\n        }\n      }\n    },\n    \"toolbar\": {\n      icons: []\n    }\n  },\n  \"fontFamily\": [{\n    \"name\": \"宋体\",\n    value: \"宋体, SimSun\",\n    defualt: true\n  }, {\n    \"name\": \"隶书\",\n    value: \"隶书, SimLi\"\n  }, {\n    \"name\": \"楷体\",\n    value: \"楷体, SimKai\"\n  }, {\n    \"name\": \"微软雅黑\",\n    value: \"微软雅黑, Microsoft YaHei\"\n  }, {\n    \"name\": \"黑体\",\n    value: \"黑体, SimHei\"\n  }, {\n    \"name\": \"arial\",\n    value: \"arial, helvetica, sans-serif\"\n  }, {\n    \"name\": \"arial black\",\n    value: \"arial black, avant garde\"\n  }, {\n    \"name\": \"omic sans ms\",\n    value: \"omic sans ms\"\n  }, {\n    \"name\": \"impact\",\n    value: \"impact, chicago\"\n  }, {\n    \"name\": \"times new roman\",\n    value: \"times new roman\"\n  }, {\n    \"name\": \"andale mono\",\n    value: \"andale mono\"\n  }],\n  \"fontSize\": [{\n    \"name\": \"10px\",\n    value: \"1\"\n  }, {\n    \"name\": \"12px\",\n    value: \"2\"\n  }, {\n    \"name\": \"16px\",\n    value: \"3\",\n    defualt: true\n  }, {\n    \"name\": \"18px\",\n    value: \"4\"\n  }, {\n    \"name\": \"24px\",\n    value: \"5\"\n  }, {\n    \"name\": \"32px\",\n    value: \"6\"\n  }, {\n    \"name\": \"38px\",\n    value: \"7\"\n  }],\n  \"paragraph\": [{\n    \"name\": \"段落\",\n    value: \"p\",\n    defualt: true\n  }, {\n    \"name\": \"标题1\",\n    value: \"h1\"\n  }, {\n    \"name\": \"标题2\",\n    value: \"h2\"\n  }, {\n    \"name\": \"标题3\",\n    value: \"h3\"\n  }, {\n    \"name\": \"标题4\",\n    value: \"h4\"\n  }, {\n    \"name\": \"标题5\",\n    value: \"h5\"\n  }, {\n    \"name\": \"标题6\",\n    value: \"h6\"\n  }],\n  \"icons\": [// video map print preview drafts link unlink formula\n  \"source | undo redo | bold italic underline strikethrough fontborder emphasis | \", \"paragraph fontfamily fontsize | superscript subscript | \", \"forecolor backcolor | removeformat | insertorderedlist insertunorderedlist | selectall | \", \"cleardoc  | indent outdent | justifyleft justifycenter justifyright | touppercase tolowercase | \", \"horizontal date time  | image emotion spechars | inserttable\"],\n  \"value\": \"\",\n  \"defaultValue\": \"\"\n};","map":null,"metadata":{},"sourceType":"script"}